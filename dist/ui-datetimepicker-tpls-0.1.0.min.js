angular.module("ui.bootstrap.datetimepicker",["ui.bootstrap.dateparser","ui.bootstrap.position","template/datetimepicker/datetimepicker.html","template/datetimepicker/day.html","template/datetimepicker/time.html"]).constant("datetimepickerConfig",{formatDay:"dd",formatMonth:"MMMM",formatYear:"yyyy",formatDayHeader:"EEE",formatDayTitle:"MMMM yyyy",formatMonthTitle:"yyyy",datetimepickerMode:"day",minMode:"time",maxMode:"year",showWeeks:!0,startingDay:0,yearRange:20,minDate:null,maxDate:null,hourStep:1,minuteStep:1,showMeridian:!0,meridians:null,readonlyInput:!1,mousewheel:!0,showTime:!0,showDate:!0}).controller("DatetimepickerController",["$scope","$attrs","$parse","$interpolate","$timeout","$log","$locale","dateFilter","datetimepickerConfig",function(a,b,c,d,e,f,g,h,i){function j(){var a=parseInt(r.hours,10),b=r.showMeridian?a>0&&13>a:a>=0&&24>a;return b?(r.showMeridian&&(12===a&&(a=0),r.meridian===q[1]&&(a+=12)),a):void 0}function k(){var a=parseInt(r.minutes,10);return a>=0&&60>a?a:void 0}function l(a){return angular.isDefined(a)&&a.toString().length<2?"0"+a:a}function m(a){var b=new Date(n.activeDate.getTime()+6e4*a);n.activeDate.setHours(b.getHours(),b.getMinutes()),n.refreshTime()}var n=this,o={$setViewValue:angular.noop};this.modes=["time","day","month","year"],angular.forEach(["formatDay","formatMonth","formatYear","formatDayHeader","formatDayTitle","formatMonthTitle","minMode","maxMode","showWeeks","startingDay","yearRange","showTime","showDate"],function(c,e){n[c]=angular.isDefined(b[c])?8>e?d(b[c])(a.$parent):a.$parent.$eval(b[c]):i[c]}),angular.forEach(["minDate","maxDate"],function(d){b[d]?a.$parent.$watch(c(b[d]),function(a){n[d]=a?new Date(a):null,n.refreshView()}):n[d]=i[d]?new Date(i[d]):null}),a.showTime=n.showTime,a.showDate=n.showDate,angular.forEach(["showTime","showDate"],function(d){b[d]&&a.$parent.$watch(c(b[d]),function(b){a[d]=b,"showTime"==d?(n.minMode=b?"time":"day",n.modes.indexOf(a.datetimepickerMode)<n.modes.indexOf(n.minMode)&&(a.datetimepickerMode=n.minMode)):"showDate"==d&&(n.maxMode=b?"year":"time",n.modes.indexOf(a.datetimepickerMode)>n.modes.indexOf(n.maxMode)&&(a.datetimepickerMode=n.maxMode)),n.refreshView()})}),a.datetimepickerMode=a.datetimepickerMode||i.datetimepickerMode,a.uniqueId="datetimepicker-"+a.$id+"-"+Math.floor(1e4*Math.random()),this.activeDate=angular.isDefined(b.initDate)?a.$parent.$eval(b.initDate):new Date,a.isActive=function(b){return 0===n.compare(b.date,n.activeDate)?(a.activeDateId=b.uid,!0):!1},this.init=function(a){o=a,o.$render=function(){n.render()}},this.render=function(){if(o.$modelValue){var a=new Date(o.$modelValue),b=!isNaN(a);b?this.activeDate=a:f.error('Datepicker directive: "ng-model" value must be a Date object, a number of milliseconds since 01.01.1970 or a string representing an RFC2822 or ISO 8601 date.'),o.$setValidity("date",b),o.$setValidity("time",b)}this.refreshView()},this.refreshView=function(){if(this.element){this._refreshView();var a=o.$modelValue?new Date(o.$modelValue):null;o.$setValidity("date-disabled",!a||this.element&&!this.isDisabled(a))}},this.createDateObject=function(a,b){var c=o.$modelValue?new Date(o.$modelValue):null;return{date:a,label:h(a,b),selected:c&&0===this.compare(a,c),disabled:this.isDisabled(a),current:0===this.compare(a,new Date)}},this.isDisabled=function(c){return this.minDate&&this.compare(c,this.minDate)<0||this.maxDate&&this.compare(c,this.maxDate)>0||b.dateDisabled&&a.dateDisabled({date:c,mode:a.datetimepickerMode})},this.split=function(a,b){for(var c=[];a.length>0;)c.push(a.splice(0,b));return c},a.select=function(b){if("day"==a.datetimepickerMode||a.datetimepickerMode===n.minMode){var c=o.$modelValue?new Date(o.$modelValue):new Date(0,0,0,0,0,0,0);c.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),o.$setViewValue(c),o.$render()}else n.activeDate=b,a.datetimepickerMode=n.modes[n.modes.indexOf(a.datetimepickerMode)-1]},a.move=function(a){var b=n.activeDate.getFullYear()+a*(n.step.years||0),c=n.activeDate.getMonth()+a*(n.step.months||0);n.activeDate.setFullYear(b,c,1),n.refreshView()},a.toggleMode=function(b){b=b||1,a.datetimepickerMode===n.maxMode&&1===b||a.datetimepickerMode===n.minMode&&-1===b||(a.datetimepickerMode=n.modes[n.modes.indexOf(a.datetimepickerMode)+b])},a.keys={13:"enter",32:"space",33:"pageup",34:"pagedown",35:"end",36:"home",37:"left",38:"up",39:"right",40:"down"};var p=function(){e(function(){n.element[0].focus()},0,!1)};a.$on("datetimepicker.focus",p),a.keydown=function(b){var c=a.keys[b.which];if(c&&!b.shiftKey&&!b.altKey)if(b.preventDefault(),b.stopPropagation(),"enter"===c||"space"===c){if(n.isDisabled(n.activeDate))return;a.select(n.activeDate),p()}else!b.ctrlKey||"up"!==c&&"down"!==c?(n.handleKeyDown(c,b),n.refreshView()):(a.toggleMode("up"===c?1:-1),p())};var q=angular.isDefined(b.meridians)?a.$parent.$eval(b.meridians):i.meridians||g.DATETIME_FORMATS.AMPMS,r=a.time={};this.initTime=function(c){var d=c.eq(0),e=c.eq(1),f=angular.isDefined(b.mousewheel)?a.$parent.$eval(b.mousewheel):i.mousewheel;f&&this.setupMousewheelEvents(d,e),r.readonlyInput=angular.isDefined(b.readonlyInput)?a.$parent.$eval(b.readonlyInput):i.readonlyInput,this.setupInputEvents(d,e)};var s=i.hourStep;b.hourStep&&a.$parent.$watch(c(b.hourStep),function(a){s=parseInt(a,10)});var t=i.minuteStep;b.minuteStep&&a.$parent.$watch(c(b.minuteStep),function(a){t=parseInt(a,10)}),r.showMeridian=i.showMeridian,b.showMeridian&&a.$parent.$watch(c(b.showMeridian),function(a){if(r.showMeridian=!!a,o.$error.time){var b=j(),c=k();angular.isDefined(b)&&angular.isDefined(c)&&(n.activeDate.setHours(b),n.refreshTime())}else n.updateTimeTemplate()}),this.setupMousewheelEvents=function(b,c){var d=function(a){a.originalEvent&&(a=a.originalEvent);var b=a.wheelDelta?a.wheelDelta:-a.deltaY;return a.detail||b>0};b.bind("mousewheel wheel",function(b){a.$apply(d(b)?r.incrementHours():r.decrementHours()),b.preventDefault()}),c.bind("mousewheel wheel",function(b){a.$apply(d(b)?r.incrementMinutes():r.decrementMinutes()),b.preventDefault()})},this.setupInputEvents=function(b,c){if(r.readonlyInput)return r.updateHours=angular.noop,void(r.updateMinutes=angular.noop);var d=function(a,b){o.$setViewValue(null),o.$setValidity("time",!1),angular.isDefined(a)&&(r.invalidHours=a),angular.isDefined(b)&&(r.invalidMinutes=b)};r.updateHours=function(){var a=j();angular.isDefined(a)?(n.activeDate.setHours(a),n.refreshTime("h")):d(!0)},b.bind("blur",function(){!r.invalidHours&&r.hours<10&&a.$apply(function(){r.hours=l(r.hours)})}),r.updateMinutes=function(){var a=k();angular.isDefined(a)?(n.activeDate.setMinutes(a),n.refreshTime("m")):d(void 0,!0)},c.bind("blur",function(){!r.invalidMinutes&&r.minutes<10&&a.$apply(function(){r.minutes=l(r.minutes)})})},this.refreshTime=function(a){n.makeValidTime(),o.$setViewValue(new Date(n.activeDate)),n.updateTimeTemplate(a)},this.makeValidTime=function(){o.$setValidity("time",!0),r.invalidHours=!1,r.invalidMinutes=!1},this.updateTimeTemplate=function(a){var b=n.activeDate.getHours(),c=n.activeDate.getMinutes();r.showMeridian&&(b=0===b||12===b?12:b%12),r.hours="h"===a?b:l(b),r.minutes="m"===a?c:l(c),r.meridian=n.activeDate.getHours()<12?q[0]:q[1]},r.incrementHours=function(){m(60*s)},r.decrementHours=function(){m(60*-s)},r.incrementMinutes=function(){m(t)},r.decrementMinutes=function(){m(-t)},r.toggleMeridian=function(){m(720*(n.activeDate.getHours()<12?1:-1))}}]).directive("datetimepicker",function(){return{restrict:"EA",replace:!0,templateUrl:"template/datetimepicker/datetimepicker.html",scope:{datetimepickerMode:"=?",dateDisabled:"&"},require:["datetimepicker","?^ngModel"],controller:"DatetimepickerController",link:function(a,b,c,d){var e=d[0],f=d[1];e.ngModelCtrl=f,f&&e.init(f)}}}).directive("dtTimepicker",["$timeout",function(a){return{restrict:"EA",require:"^datetimepicker",replace:!0,templateUrl:"template/datetimepicker/time.html",link:function(b,c,d,e){var f=c.find("input");e.step={},e.element=c,e._refreshView=function(){e.makeValidTime(),e.updateTimeTemplate()},e.compare=function(a,b){return a.getFullYear()-b.getFullYear()},e.handleKeyDown=function(c,d){if("input"!==d.target.nodeName.toLowerCase())return void("left"==c?a(function(){f.last().focus()}):"right"==c&&a(function(){f.first().focus()}));var e=$(d.target),g=e.data("part");"up"==c?"hour"==g?b.time.incrementHours():b.time.incrementMinutes():"down"==c?"hour"==g?b.time.decrementHours():b.time.decrementMinutes():("left"==c||"right"==c)&&a(function(){f.not(d.target).focus()})},e.initTime(f),e.refreshView()}}}]).directive("dtDaypicker",["daypickerDirective",function(a){var b=angular.extend({},a[0]);return b.name="dtDaypicker",b.templateUrl="template/datetimepicker/day.html",b.require="^datetimepicker",b}]).directive("dtMonthpicker",["monthpickerDirective",function(a){var b=angular.extend({},a[0]);return b.name="dtMonthpicker",b.require="^datetimepicker",b}]).directive("dtYearpicker",["yearpickerDirective",function(a){var b=angular.extend({},a[0]);return b.name="dtYearpicker",b.require="^datetimepicker",b}]).constant("datetimepickerPopupConfig",{datetimepickerPopup:"yyyy-MM-dd",currentText:"Current",clearText:"Clear",closeText:"Done",closeOnDateSelection:!1,appendToBody:!1,showButtonBar:!0}).controller("DatetimepickerPopupInputGroupCtrl",["$scope",function(a){a.$dtp={toggle:function(a,b){a.preventDefault(),a.stopPropagation(),this.models[b]||(this.models[b]={}),this.models[b].opened=!this.models[b].opened},models:{}}}]).directive("datetimepickerPopup",["$compile","$parse","$document","$position","$timeout","dateFilter","dateParser","datetimepickerPopupConfig",function(a,b,c,d,e,f,g,h){return{restrict:"EA",require:"ngModel",scope:{isOpen:"=?",currentText:"@",clearText:"@",closeText:"@",dateDisabled:"&",openOnFocus:"@"},link:function(i,j,k,l){function m(a){return a.replace(/([A-Z])/g,function(a){return"-"+a.toLowerCase()})}function n(a){if(a){if(angular.isDate(a)&&!isNaN(a))return l.$setValidity("date",!0),a;if(angular.isString(a)){var b=g.parse(a,o)||new Date(a);return isNaN(b)?void l.$setValidity("date",!1):(l.$setValidity("date",!0),b)}return void l.$setValidity("date",!1)}return l.$setValidity("date",!0),null}var o,p=angular.isDefined(k.closeOnDateSelection)?i.$parent.$eval(k.closeOnDateSelection):h.closeOnDateSelection,q=angular.isDefined(k.datepickerAppendToBody)?i.$parent.$eval(k.datepickerAppendToBody):h.appendToBody;i.showButtonBar=angular.isDefined(k.showButtonBar)?i.$parent.$eval(k.showButtonBar):h.showButtonBar,i.getText=function(a){return i[a+"Text"]||h[a+"Text"]};var r=function(a){if("string"!=typeof a||a.length>1)throw new TypeError("isEnabled expects a single character string parameter");switch(a){case"y":return-1!==o.indexOf("Y");case"M":return-1!==o.indexOf("M");case"d":return-1!==o.toLowerCase().indexOf("d");case"h":case"H":return-1!==o.toLowerCase().indexOf("h");case"m":return-1!==o.indexOf("m");case"s":return-1!==o.indexOf("s");default:return!1}},s=function(){return r("h")||r("m")||r("s")},t=function(){return r("y")||r("M")||r("d")},u=angular.element("<div datetimepicker-popup-wrap><div datetimepicker></div></div>");u.attr({"ng-model":"date","ng-change":"dateSelection()"});var v=angular.element(u.children()[0]);k.datepickerOptions&&angular.forEach(i.$parent.$eval(k.datepickerOptions),function(a,b){v.attr(m(b),a)}),i.watchData={showTime:!0,showDate:!0},v.attr("show-time","watchData.showTime"),v.attr("show-date","watchData.showDate"),angular.forEach(["minDate","maxDate","datetimepickerMode"],function(a){if(k[a]){var c=b(k[a]);if(i.$parent.$watch(c,function(b){i.watchData[a]=b}),v.attr(m(a),"watchData."+a),"datetimepickerMode"===a){var d=c.assign;i.$watch("watchData."+a,function(a,b){a!==b&&d(i.$parent,a)})}}}),k.$observe("datetimepickerPopup",function(a){o=a||h.datetimepickerPopup,i.watchData.showTime=s(),i.watchData.showDate=t(),l.$render()}),k.dateDisabled&&v.attr("date-disabled","dateDisabled({ date: date, mode: mode })"),l.$parsers.unshift(n),i.dateSelection=function(a){angular.isDefined(a)&&(i.date=a),l.$setViewValue(i.date),l.$render(),p&&(i.isOpen=!1,j[0].focus())},j.bind("input change keyup",function(){i.$apply(function(){i.date=l.$modelValue})}),l.$render=function(){i.date=n(l.$modelValue);var a=i.date?f(i.date,o):"";j.val(a)};var w=function(a){i.isOpen&&a.target!==j[0]&&i.$apply(function(){i.isOpen=!1})},x=!0,y=function(){return x?void e(function(){i.isOpen=!0}):void(x=!0)};i.openOnFocus&&j.bind("focus",y);var z=function(a){i.keydown(a)};j.bind("keydown",z),i.keydown=function(a){27===a.which?(x=!1,a.preventDefault(),a.stopPropagation(),i.close()):40!==a.which||i.isOpen||(i.isOpen=!0,a.stopPropagation())},i.$watch("isOpen",function(a){a?(i.$broadcast("datetimepicker.focus"),i.position=q?d.offset(j):d.position(j),i.position.top=i.position.top+j.prop("offsetHeight"),c.bind("click",w)):c.unbind("click",w)}),i.select=function(a){if("today"===a){var b=new Date;angular.isDate(l.$modelValue)?(a=new Date(l.$modelValue),a.setFullYear(b.getFullYear(),b.getMonth(),b.getDate()),a.setHours(b.getHours(),b.getMinutes(),b.getSeconds())):a=new Date}i.dateSelection(a)},i.close=function(){i.isOpen=!1,i.openOnFocus||j[0].focus()};var A=a(u)(i);u.remove(),q?c.find("body").append(A):j.after(A),i.$on("$destroy",function(){A.remove(),j.unbind("keydown",z),j.unbind("focus",y),c.unbind("click",w)})}}}]).directive("datetimepickerPopupWrap",function(){return{restrict:"EA",replace:!0,transclude:!0,templateUrl:"template/datepicker/popup.html",link:function(a,b){b.bind("click",function(a){a.preventDefault(),a.stopPropagation()})}}}),angular.module("template/datetimepicker/datetimepicker.html",[]).run(["$templateCache",function(a){a.put("template/datetimepicker/datetimepicker.html",'<div ng-switch="datetimepickerMode" role="application" ng-keydown="keydown($event)">\n    <dt-timepicker ng-switch-when="time" tabindex="0"></dt-timepicker>\n    <dt-daypicker ng-switch-when="day" tabindex="0"></dt-daypicker>\n    <dt-monthpicker ng-switch-when="month" tabindex="0"></dt-monthpicker>\n    <dt-yearpicker ng-switch-when="year" tabindex="0"></dt-yearpicker>\n</div>')}]),angular.module("template/datetimepicker/day.html",[]).run(["$templateCache",function(a){a.put("template/datetimepicker/day.html",'<table role="grid" aria-labelledby="{{uniqueId}}-title" aria-activedescendant="{{activeDateId}}">\n    <thead>\n        <tr>\n            <th><button type="button" class="btn btn-default btn-sm pull-left" ng-click="move(-1)" tabindex="-1"><span class="glyphicon glyphicon-chevron-left"></span></button></th>\n            <th colspan="{{5 + showWeeks}}"><button id="{{uniqueId}}-title" role="heading" aria-live="assertive" aria-atomic="true" type="button" class="btn btn-default btn-sm" ng-click="toggleMode()" tabindex="-1" style="width:100%;"><strong>{{title}}</strong></button></th>\n            <th><button type="button" class="btn btn-default btn-sm pull-right" ng-click="move(1)" tabindex="-1"><span class="glyphicon glyphicon-chevron-right"></span></button></th>\n        </tr>\n        <tr>\n            <th ng-show="showWeeks" class="text-center"></th>\n            <th ng-repeat="label in labels track by $index" class="text-center"><small aria-label="{{label.full}}">{{label.abbr}}</small></th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr ng-repeat="row in rows track by $index">\n            <td ng-show="showWeeks" class="text-center h6"><em>{{ weekNumbers[$index] }}</em></td>\n            <td ng-repeat="dt in row track by dt.date" class="text-center" role="gridcell" id="{{dt.uid}}" aria-disabled="{{!!dt.disabled}}">\n                <button type="button" style="width:100%;" class="btn btn-default btn-sm" ng-class="{\'btn-info\': dt.selected, active: isActive(dt)}" ng-click="select(dt.date)" ng-disabled="dt.disabled" tabindex="-1"><span ng-class="{\'text-muted\': dt.secondary, \'text-info\': dt.current}">{{dt.label}}</span></button>\n            </td>\n        </tr>\n    </tbody>\n    <tfoot ng-if="showTime">\n        <tr>\n            <td colspan="{{7 + showWeeks}}">\n                <div calss="text-center" style="padding:10px 9px 2px">\n                    <a ng-click="toggleMode(-1)" class="btn btn-link" style="width:100%"><span class="glyphicon glyphicon-time"></span></a>\n                </div>\n            </td>\n        </tr>\n    </tfoot>\n</table>')}]),angular.module("template/datetimepicker/time.html",[]).run(["$templateCache",function(a){a.put("template/datetimepicker/time.html",'<table class="text-center" style="margin: 20px;">\n    <thead>\n        <tr>\n            <td colspan="5">\n                <div class="text-center" style="padding:10px 9px 2px">\n                    <a ng-click="toggleMode()" class="btn btn-link" style="width:100%"><span class="glyphicon glyphicon-calendar"></span></a>\n                </div>\n            </td>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td><a ng-click="time.incrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n            <td>&nbsp;</td>\n            <td><a ng-click="time.incrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-up"></span></a></td>\n            <td>&nbsp;</td>\n            <td ng-show="time.showMeridian"></td>\n        </tr>\n        <tr>\n            <td style="width:50px;"  class="form-group" ng-class="{\'has-error\': time.invalidHours}">\n                <input style="width:50px;" type="text" ng-model="time.hours" data-part="hour" ng-change="time.updateHours()" class="form-control text-center" ng-mousewheel="time.incrementHours()" ng-readonly="time.readonlyInput" maxlength="2">\n            </td>\n            <td style="width:50px;">:</td>\n            <td style="width:50px;" class="form-group" ng-class="{\'has-error\': time.invalidMinutes}">\n                <input style="width:50px;" type="text" ng-model="time.minutes" data-part="minute" ng-change="time.updateMinutes()" class="form-control text-center" ng-readonly="time.readonlyInput" maxlength="2">\n            </td>\n            <td style="width:20px;">&nbsp;</td>\n            <td style="width:50px;" ng-show="time.showMeridian" ><button type="button" class="btn btn-primary text-center" ng-click="time.toggleMeridian()">{{time.meridian}}</button></td>\n        </tr>\n        <tr class="text-center">\n            <td><a ng-click="time.decrementHours()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n            <td>&nbsp;</td>\n            <td><a ng-click="time.decrementMinutes()" class="btn btn-link"><span class="glyphicon glyphicon-chevron-down"></span></a></td>\n            <td>&nbsp;</td>\n            <td ng-show="time.showMeridian"></td>\n        </tr>\n    </tbody>\n</table>')}]);